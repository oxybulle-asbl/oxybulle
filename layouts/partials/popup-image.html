<!-- layouts/partials/popup-image.html -->
{{ if .Params.popup.enable }}
{{ $desktop := .Params.popup.desktop | default "images/insta.png" }}
{{ $mobile  := .Params.popup.mobile  | default "images/insta-mobile.png" }}
{{ $link    := .Params.popup.link    | default "https://www.instagram.com/oxybulle_asbl/" }}

<div id="popup-overlay" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
  <div id="popup-content" class="relative max-w-3xl w-full max-h-[90vh] -translate-y-5 rounded-lg overflow-hidden">
    
    <!-- bouton X -->
    <button id="close-popup" class="absolute top-4 right-4 z-30 bg-black/60 text-white rounded-full p-2 hover:bg-black/80 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Desktop -->
    {{ with resources.Get $desktop }}
      <a href="{{ $link }}" target="_blank">
        <img src="{{ .Permalink }}" alt="Popup desktop" class="w-full h-auto hidden sm:block object-cover">
      </a>
    {{ end }}

    <!-- Mobile -->
    {{ with resources.Get $mobile }}
      <a href="{{ $link }}" target="_blank">
        <img src="{{ .Permalink }}" alt="Popup mobile" class="w-full h-auto block sm:hidden object-cover">
      </a>
    {{ end }}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const popup = document.getElementById('popup-overlay');
    const closeBtn = document.getElementById('close-popup');

    // affiche le popup au chargement
    popup.classList.remove('hidden');

    // fermeture par X
    closeBtn.addEventListener('click', () => popup.classList.add('hidden'));
  });
</script>
{{ end }}